{"filter":false,"title":"excels_controller.rb","tooltip":"/Hora_ARMS/app/controllers/admins/excels_controller.rb","undoManager":{"mark":14,"position":14,"stack":[[{"start":{"row":0,"column":0},"end":{"row":36,"column":3},"action":"insert","lines":["class Admins::ExcelsController < ApplicationController","  before_action :authenticate_admin!","","  def index","    @workers = Worker.all","    @attendances = Attendance.all","","    @years = (Date.current.year - 5..Date.current.year + 1).to_a.reverse","    @today = params[:month].present? ? Date.new(params[:year].to_i, params[:month].to_i, 1) : Date.current","","    current_month = Array.new(35){ |i| @today.beginning_of_month + ( i - @today.beginning_of_month.wday) }","    @current_month = current_month.filter { |day| @today.mon == day.mon }","","    @current_month = @current_month.map do |day|","      { date: day, weekday_jp: convert_to_japanese_weekday(day.wday) }","    end","","    respond_to do |format|","      format.html","      format.xlsx do","        response.headers['Content-Disposition'] = \"attachment; filename=#{@today.year}年#{@today.mon}月勤怠情報.xlsx\"","      end","    end","  end","","private","","  def attendance_params","    params.require(:attendance).permit(:worker_id, :start_worktime, :finish_worktime, :start_breaktime, :finish_breaktime, :comment, :reason_status, :stamp_date)","  end","","  def convert_to_japanese_weekday(wday)","    weekdays = %w[(日) (月) (火) (水) (木) (金) (土)]","    weekdays[wday]","  end","","end"],"id":423}],[{"start":{"row":32,"column":18},"end":{"row":32,"column":19},"action":"remove","lines":["("],"id":424}],[{"start":{"row":32,"column":19},"end":{"row":32,"column":20},"action":"remove","lines":[")"],"id":425}],[{"start":{"row":32,"column":20},"end":{"row":32,"column":21},"action":"remove","lines":["("],"id":426}],[{"start":{"row":32,"column":21},"end":{"row":32,"column":22},"action":"remove","lines":[")"],"id":427}],[{"start":{"row":32,"column":22},"end":{"row":32,"column":23},"action":"remove","lines":["("],"id":428}],[{"start":{"row":32,"column":23},"end":{"row":32,"column":24},"action":"remove","lines":[")"],"id":429}],[{"start":{"row":32,"column":24},"end":{"row":32,"column":25},"action":"remove","lines":["("],"id":430}],[{"start":{"row":32,"column":25},"end":{"row":32,"column":26},"action":"remove","lines":[")"],"id":431}],[{"start":{"row":32,"column":26},"end":{"row":32,"column":27},"action":"remove","lines":["("],"id":432}],[{"start":{"row":32,"column":27},"end":{"row":32,"column":28},"action":"remove","lines":[")"],"id":433}],[{"start":{"row":32,"column":28},"end":{"row":32,"column":29},"action":"remove","lines":["("],"id":434}],[{"start":{"row":32,"column":29},"end":{"row":32,"column":30},"action":"remove","lines":[")"],"id":437}],[{"start":{"row":32,"column":30},"end":{"row":32,"column":31},"action":"remove","lines":["("],"id":438}],[{"start":{"row":32,"column":31},"end":{"row":32,"column":32},"action":"remove","lines":[")"],"id":439}]]},"ace":{"folds":[],"scrolltop":298.5,"scrollleft":0,"selection":{"start":{"row":36,"column":3},"end":{"row":36,"column":3},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":20,"state":"start","mode":"ace/mode/ruby"}},"timestamp":1688190842971,"hash":"8fe07b0a9a2eebba37dcb278889e12d22adb422e"}